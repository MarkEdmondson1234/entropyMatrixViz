{
    "collab_server" : "",
    "contents" : "library(purrr)\n\n# A random 0 or 1 square matrix of dimensions n*m\ntest_matrix <- function(n, m = n){\n  matrix(sample(0:1, size = n*m, replace = TRUE), nrow = n, ncol = m)\n}\n\nlow_matrix <- function(n, x = 1){\n  matrix(rep(x, n^2), nrow = n)\n}\n\n#' Sum the sub-matrix in my_matrix for sub-matrix of size k\n#' @importFrom purrr\n#' @return A matrix of sums, where each coordinate is sum of matrix size k in position in original matrix\nf_subset <- function(my_matrix, k, f = sum){\n  my_dim <- dim(my_matrix)\n  k_n <- (k-1)\n  along <- my_dim[1] - k_n\n  down  <- my_dim[2] - k_n\n  map(1:along, \n      ~ map_dbl(1:down, \n                function(y) f(my_matrix[.x:(.x+k_n), y:(y+k_n)])\n                )\n      ) %>% \n    unlist %>% matrix(ncol = along, byrow = TRUE) / k^2\n\n}\n\nall_ks <- function(my_matrix){\n  my_dim <- dim(my_matrix)\n  along <- 1:(min(my_dim))\n  along <- setNames(along, along)\n  map_dbl(along, ~ mean(f_subset(my_matrix, .)))\n}\n\nplot_ks <- function(my_matrix){\n  my_dim <- dim(my_matrix)\n\n  along <- all_ks(my_matrix)\n  \n  par(mfrow = c(ceiling(sqrt(my_dim[1])), ceiling(sqrt(my_dim[2]))),\n      mar = c(1.5,1.5,1.5,1.5))\n  \n  walk(names(along), \n       function(x){\n         aa <- along[[x]]\n         image(f_subset(my_matrix, as.numeric(x)),\n                col = RColorBrewer::brewer.pal(3, \"Oranges\"))\n         title(main = paste(\"k=\",x, \" S = \", round(aa, 2)))\n         \n       })\n  \n  along\n}\n\nmy_matrix <- test_matrix(10)\nmm <- matrix(c(1,0,0,0,1,0,0,1,0,0,0,1,0,1,1,1,0,0,0,0,0,1,0,1,1), nrow = 5, byrow = TRUE)\nm_reg <- suppressWarnings(matrix(rep(0:1, 11), nrow = 5))\nm_lowest <- low_matrix(5)\nmm_big <- test_matrix(100)\nm_big_lowest <- low_matrix(100)\n\nplot_ks(mm)\nplot_ks(m_reg)\nplot_ks(m_lowest)\nplot_ks(mm_big)\nplot_ks(m_big_lowest)\n",
    "created" : 1504776456594.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "492232054",
    "id" : "3EEB9677",
    "lastKnownWriteTime" : 1504785708,
    "last_content_update" : 1504785708910,
    "path" : "~/dev/R/entropyMatrixViz/scripts/entropy.R",
    "project_path" : "scripts/entropy.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}